<!-- Translation fallback notice -->
{% comment %}
  This include provides translation options for posts
  - If a post is in English, offer Spanish translation
  - If a post is in Spanish, offer English translation
  - Always provide Google Translate as a fallback
{% endcomment %}

{% comment %}
  Detect current language based on URL and post collection
{% endcomment %}
{% assign current_lang = 'en' %}
{% if page.url contains '/es/' or page.collection == 'posts-es' %}
  {% assign current_lang = 'es' %}
{% endif %}

{% comment %}
  Detect post language based on collection
{% endcomment %}
{% assign post_lang = 'en' %}
{% if page.collection == 'posts-es' %}
  {% assign post_lang = 'es' %}
{% endif %}

{% comment %}
  Only show translation notice if we're on a post page
{% endcomment %}
{% if page.layout == 'post' %}
  <div class="translation-notice alert alert-info" role="alert">
    <div class="d-flex align-items-center">
      <i class="fas fa-language me-2"></i>
      <div>
        {% if post_lang == 'en' %}
          <strong>üåê Translation Notice:</strong> This post is currently only available in English.
          <div class="mt-2">
            <a href="https://translate.google.com/translate?sl=en&tl=es&u={{ site.url }}{{ page.url }}" 
               class="btn btn-sm btn-outline-primary me-2" target="_blank" rel="noopener">
              <i class="fas fa-language me-1"></i>Translate to Spanish
            </a>
            {% comment %}
              Check if there's a Spanish version available
            {% endcomment %}
            {% assign spanish_post = site.posts-es | where: "title", page.title | first %}
            {% if spanish_post %}
              <a href="{{ spanish_post.url | relative_url }}" class="btn btn-sm btn-success">
                <i class="fas fa-flag me-1"></i>Read in Spanish
              </a>
            {% endif %}
          </div>
        {% else %}
          <strong>üåê Aviso de Traducci√≥n:</strong> Esta entrada est√° disponible solo en espa√±ol.
          <div class="mt-2">
            <a href="https://translate.google.com/translate?sl=es&tl=en&u={{ site.url }}{{ page.url }}" 
               class="btn btn-sm btn-outline-primary me-2" target="_blank" rel="noopener">
              <i class="fas fa-language me-1"></i>Traducir al Ingl√©s
            </a>
            {% comment %}
              Check if there's an English version available
            {% endcomment %}
            {% assign english_post = site.posts | where: "title", page.title | first %}
            {% if english_post %}
              <a href="{{ english_post.url | relative_url }}" class="btn btn-sm btn-success">
                <i class="fas fa-flag me-1"></i>Read in English
              </a>
            {% endif %}
          </div>
        {% endif %}
      </div>
    </div>
  </div>
{% endif %}
